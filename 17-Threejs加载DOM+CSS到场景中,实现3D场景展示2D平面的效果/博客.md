# ThreejsåŠ è½½DOM+CSSåˆ°åœºæ™¯ä¸­,å®ç°3Dåœºæ™¯å±•ç¤º2Då¹³é¢çš„æ•ˆæœ

## 1. å‰è¨€
æœ¬ç¯‡æ–‡ç« ä¸»è¦å®ç°äº†å°†**DOM**å…ƒç´ è½¬æ¢ä¸ºThreejså¯ä»¥ä½¿ç”¨çš„æ•°æ®ç»“æ„,ä½¿ç”¨**CSS2DRenderer**æ¸²æŸ“å™¨æ¸²æŸ“è¿™äº›**DOM+CSS**çš„å¹³é¢,ä½¿å…¶å¯ä»¥ä½œä¸ºä¸€ä¸ªç‰©ä½“æ·»åŠ åˆ°Threejsåœºæ™¯é‡Œ

å¦‚ä¸‹æ•ˆæœå›¾:
![æ•ˆæœå›¾](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/581d65859b7c4c82acf19bc109ce66c3~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1920&h=911&s=43759&e=png&b=3f53b5)

## 2. å®ç°æ­¥éª¤
1. é¦–å…ˆåˆ›å»ºä¸€ä¸ª**Threejs+Vue+Vite**çš„é¡¹ç›®,ä½œä¸ºæœ¬æ¬¡çš„**demoé¡¹ç›®**
2. ä¸‹è½½**Threejs**ç¬¬ä¸‰æ–¹åº“
```js
yarn add three
// è·
npm install three
```
3. åˆå§‹åŒ–Threejsåœºæ™¯
```js
// åˆ›å»ºç›¸æœº,åœºæ™¯,æ§åˆ¶å™¨,æ¸²æŸ“å™¨,ç¯å…‰,è¾…åŠ©çº¿ç­‰ç­‰...
<!--
 * @Author: wangzhiyu <w19165802736@163.com>
 * @version: 1.0.0
 * @Date: 2024-03-14 15:44:26
 * @LastEditTime: 2024-06-05 21:03:38
 * @Descripttion: åœ¨Threejsä¸­åŠ è½½CSSä¸HTMLæ ‡ç­¾
-->
<template></template>

<script setup>
import { onMounted } from 'vue';
// å¯¼å…¥threejs
import * as THREE from 'three';
// å¯¼å…¥è½¨é“æ§åˆ¶å™¨
import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
// åˆå§‹åŒ–åœºæ™¯,ç›¸æœº,æ¸²æŸ“å™¨
const scene = new THREE.Scene();
// THREE.PerspectiveCamera(æ‘„åƒæœºå‚ç›´è§’åº¦, æ‘„åƒæœºå®½é«˜æ¯”,æ‘„åƒæœºè¿‘ç«¯é¢,æ‘„åƒæœºè¿œç«¯é¢);
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
// è®¾ç½®æ‘„åƒæœºçš„ä½ç½®
camera.position.set(50, 50, 50);
// æ¸²æŸ“å™¨
const renderer = new THREE.WebGL1Renderer({ antialias: true });
// è®¾ç½®æ¸²æŸ“å™¨å°ºå¯¸
renderer.setSize(window.innerWidth, window.innerHeight);
// æ¸²æŸ“é¢œè‰²
renderer.setClearColor('#3F51B5');

// æ‘„åƒæœºæ·»åŠ åˆ°åœºæ™¯ä¸­
scene.add(camera);

// åˆ›å»ºè½¨é“æ§åˆ¶å™¨
const controls = new OrbitControls(camera, renderer.domElement);
// å¼€å¯é˜»å°¼æ•ˆæœ
controls.enableDamping = true;

// è¾…åŠ©çº¿
const axesHelper = new THREE.AxesHelper(50);
scene.add(axesHelper);

// æ¸²æŸ“å‡½æ•°
function render() {
  // æ›´æ–°æ¸²æŸ“å™¨
  renderer.render(scene, camera);
  // æ›´æ–°è½¨é“æ§åˆ¶å™¨
  controls.update();
  requestAnimationFrame(render);
}

onMounted(() => {
  render();
  document.getElementById('app').appendChild(renderer.domElement);

  // çª—å£ç¼©æ”¾å¤„ç†
  window.addEventListener('resize', () => {
    // è®¾ç½®æ¸²æŸ“å™¨å°ºå¯¸
    renderer.setSize(window.innerWidth, window.innerHeight);
    // æ›´æ–°ç›¸æœºå®½é«˜æ¯”
    camera.aspect = window.innerWidth / window.innerHeight;
    // æ›´æ–°ç›¸æœºæŠ•å½±çŸ©é˜µ
    camera.updateProjectionMatrix();
    // è®¾ç½®æ¸²æŸ“å™¨åƒç´ æ¯”
    renderer.setPixelRatio(window.innerWidth / window.innerHeight);
  });
});
</script>

<style lang="scss" scoped></style>
```
4. åœ¨å·²æœ‰çš„Threejsåœºæ™¯ä¸­åŠ å…¥**CSS2DObject**ä¸**CSS2DRenderer**æ–¹æ³•,è¿™ä¸¤ä¸ªæ–¹æ³•ä¸€ä¸ªå¯ä»¥å°†DOMè½¬æ¢ä¸ºThreejså¯ä½¿ç”¨çš„ç‰©ä½“ç±»å‹,å¯ä»¥æ·»åŠ åˆ°Threejsåˆ°åœºæ™¯ä¸­,å¦å¤–ä¸€ä¸ªæ˜¯å•ç‹¬çš„æ¸²æŸ“å™¨,å¯ä»¥åœ¨Threejsåœºæ™¯ä¸­æ¸²æŸ“**CSS2DObject**å¤„ç†è¿‡çš„**DOM+CSS**
```js
// å¼•å…¥Threejsè®¾ç½®DOM+CSSçš„å®ä¾‹åŒ–æ–¹æ³•
import { CSS2DObject, CSS2DRenderer } from 'three/examples/jsm/renderers/CSS2DRenderer';

// åˆ›å»º2Dæ¸²æŸ“å™¨
const cssRenderer = new CSS2DRenderer();
// è®¾ç½®2Dæ¸²æŸ“å™¨çš„å°ºå¯¸
cssRenderer.setSize(window.innerWidth, window.innerHeight);
// è®¾ç½®2Dæ¸²æŸ“å™¨ä¸ºç»å¯¹å®šä½,å¹¶ä¸”åœ¨é¡µé¢é¡¶éƒ¨
cssRenderer.domElement.style.position = 'absolute';
cssRenderer.domElement.style.top = '0';
// è®¾ç½®2Dæ¸²æŸ“å™¨å¯ç›´æ¥ä¼ ç»Ÿ,æ“ä½œThreejsåœºæ™¯
cssRenderer.domElement.style.pointerEvents = 'none';
// ç¡®ä¿ CSS2DRenderer ä½¿ç”¨çš„ç›¸æœºå’Œ WebGLRenderer ä½¿ç”¨çš„ç›¸æœºç›¸åŒ
cssRenderer.camera = camera;

// æ·»åŠ ä¸€ä¸ªHTML+CSSåˆ°Threejsåœºæ™¯ä¸­
function addDom() {
  // åˆ›å»ºä¸€ä¸ªDOMå…ƒç´ 
  const div = document.createElement('div');
  // è®¾ç½®DOMå…ƒç´ çš„å†…å®¹
  div.innerHTML = 'æˆ‘æ˜¯æ‰‹åŠ¨æ·»åŠ çš„htmlå…ƒç´ ,æ”¾åˆ°Threejsåœºæ™¯é‡Œ';
  // è®¾ç½®divçš„æ ·å¼
  div.style.color = '#fff';
  // ä½¿ç”¨CSS2Objectå°†domè½¬æ¢ä¸ºThreejså¯æ“ä½œçš„å¯¹è±¡
  const divThree = new CSS2DObject(div);
  // è®¾ç½®è½¬æ¢ä¸ºThreejså¯ä»¥ä½¿ç”¨çš„ç»“æ„åçš„ç‰©ä½“çš„ä½ç½®
  divThree.position.set(10, 10, 10);
  // å°†å¤„ç†åçš„å¯¹è±¡æ·»åŠ åˆ°Threejsåœºæ™¯ä¸­
  scene.add(divThree);
}

// æ¸²æŸ“å‡½æ•°
function render() {
  // ...
  // æ¸²æŸ“ CSS2D åœºæ™¯
  cssRenderer.render(scene, camera);
}

onMounted(()=>{
  // ...
  // 2Dæ¸²æŸ“å™¨æŒ‚è½½DOM
  document.getElementById('app').appendChild(cssRenderer.domElement);
  // æ‰§è¡Œæ·»åŠ DOM+CSSåˆ°åœºæ™¯ä¸­çš„æ–¹æ³•,æ·»åŠ 2Då¹³é¢
  addDom();
})
```

## 3. å…³é”®æµç¨‹
å®ç°æœ¬demoçš„å…³é”®ç‚¹å°±åœ¨äºThreejsçš„**CSS2Object**ä¸**CSS2Render**ä¸¤ä¸ªæ–¹æ³•,ç¬¬ä¸€ä¸ªæ–¹æ³•å°†**DOM+CSS**è½¬æ¢ä¸ºThreejså¯åŠ è½½çš„æ ¼å¼,ç¬¬äºŒä¸ªæ–¹æ³•åˆ™å¯ä»¥åœ¨Threejsä¸­æ¸²æŸ“**CSS2Object**è½¬æ¢ä¹‹åçš„æ ¼å¼

## 4. æ€»ç»“
ä»¥ä¸Šå°±æ˜¯æœ¬ç¯‡æ–‡ç« çš„æ‰€æœ‰å†…å®¹äº†,æ„Ÿè°¢æ‚¨é˜…è¯»åˆ°è¿™é‡Œ,æœ‰ä»€ä¹ˆæŠ€æœ¯ä¸Šçš„é—®é¢˜æˆ–è€…éœ€è¦æºç ä¹‹ç±»çš„,æ¬¢è¿ç§ä¿¡,æˆ‘ä»¬ä¸‹ç¯‡åšå®¢è§ğŸ™‚