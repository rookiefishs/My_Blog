# Vue3ä¸­ä½¿ç”¨è‡ªå®šä¹‰æŒ‡ä»¤+VueComponentsè§¦å‘è™šæ‹Ÿé”®ç›˜ğŸ˜

## 1. å‰è¨€

ä¹‹å‰åšçš„ä¸€ä¸ªé¡¹ç›®çš„ç¯å¢ƒæ˜¯ä¸€ä¸ªæ²¡æœ‰é”®ç›˜çš„è®¾å¤‡ä¸­(å±å¹•æ”¯æŒç‚¹å‡»,å¯ä»¥ä»£æ›¿é¼ æ ‡),è¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜,å¦‚æœæ²¡æœ‰é”®ç›˜,å¦‚ä½•åœ¨ç½‘é¡µä¸­çš„`input`ä¸­è¾“å…¥æ–‡å­—å‘¢?

æ ¹æ®æ­¤éœ€æ±‚æˆ‘æ‰¾åˆ°äº†[è™šæ‹Ÿé”®ç›˜](https://blog.csdn.net/weixin_43030842/article/details/135699327)è¿™ä¸€æ¦‚å¿µ,å¤§æ¦‚å°±æ˜¯ä½¿ç”¨å‰ç«¯çš„æ‰‹æ®µæ¥åœ¨é¡µé¢ä¸Šå¼¹å‡ºä¸€ä¸ªé”®ç›˜,ç„¶åç‚¹å‡»é”®ç›˜ä¸Šçš„æŒ‰é”®æ¥è¡¨ç¤ºçœŸå®é”®ç›˜æ•ˆæœ

åŠŸèƒ½æè¿°: å¯ä»¥é€šè¿‡è™šæ‹Ÿé”®ç›˜æ¥æ§åˆ¶æ¯ä¸ªè¡¨å•çš„å†…å®¹,å½“è¡¨å•èšç„¦æ—¶å¼¹å‡ºè™šæ‹Ÿé”®ç›˜,è™šæ‹Ÿé”®ç›˜ä¸­å›æ˜¾è¿™ä¸ªè¡¨å•çš„å†…å®¹,å¹¶ä¸”å†…å®¹ä¿®æ”¹å,è¿™ä¸ªè¡¨å•çš„å†…å®¹ä¹Ÿè¦åŒæ­¥ä¿®æ”¹,å¹¶ä¸”å¯ä»¥é€‚é…ä¸åŒçš„ç»„ä»¶åº“ç­‰

## ğŸ¤”2. å‡†å¤‡å·¥ä½œ
1. é¦–å…ˆæˆ‘åˆ›å»ºäº†ä¸€ä¸ª`demoé¡¹ç›®`,æ¥ä¸“é—¨å®Œæˆè¿™ä¸ªåŠŸèƒ½,ç­‰åˆ°è¿™ä¸ªåŠŸèƒ½å®Œæˆåå†å°†å…¶æ¥å…¥åˆ°å¼€å‘é¡¹ç›®ä¸­ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢å¼€å‘æ—¶è°ƒè¯•èµ·æ¥éå¸¸ç®€ä»‹,ä¹Ÿä¸éœ€è¦çº¿ä¸Šé¡¹ç›®ä¸­é‚£ä¹ˆå¤šç¯å¢ƒä¹‹ç±»çš„é…ç½®(os: ä¸Šå‡ ç¯‡æ–‡ç« çš„`fabric.js`ä¹Ÿæ˜¯ç”¨è¿™ç§æ–¹æ³•,éå¸¸æœ‰æ•ˆ,å¯ä»¥å°è¯•ä¸€ä¸‹å“¦!)
2. åˆ›å»ºVue3é¡¹ç›®

    ```js
        yarn create vite
        npm init vite@latest 
        pnpm create vite 
    ```
    
    ![åˆ›å»ºVue3é¡¹ç›®](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0bb02aa58a14c109cdfc9b873d1bac3~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=333&h=37&s=13022&e=png&b=020202)

3. è¾“å…¥é¡¹ç›®åç§°

    ![ç„¶åè¾“å…¥é¡¹ç›®åç§°](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c14705c152aa4c889ee2f4ba4df6a3a3~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=353&h=143&s=33591&e=png&b=010101)

4. ç‚¹å‡»é”®ç›˜ä¸Šä¸‹æ–¹å‘é”®åˆ°Vue,å†æŒ‰å›è½¦é€‰æ‹©vue

    ![ç‚¹å‡»é”®ç›˜ä¸Šä¸‹æ–¹å‘é”®åˆ°Vue,å†æŒ‰å›è½¦é€‰æ‹©vue](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/93ac8858387441bf955305b9e7a2a855~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=614&h=325&s=69649&e=png&b=000000)

5. ç»§ç»­æŒ‰ç…§å¦‚ä¸Šæ–¹å¼é€‰æ‹©JavaScript

    ![ç»§ç»­æŒ‰ç…§å¦‚ä¸Šæ–¹å¼é€‰æ‹©JavaScript](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/901eefd4b95e49ccbbcccf31bd573c34~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=628&h=237&s=80282&e=png&b=010101)

6. æ‰“å¼€é¡¹ç›®,åˆå§‹åŒ–ä¾èµ–åŒ…

    æ­¤æ—¶é¡¹ç›®å·²ç»åˆ›å»ºå®Œæ¯•,å¯ä»¥é€šè¿‡cdå‘½ä»¤è¿›å…¥é¡¹ç›®æ ¹ç›®å½•åè¿›è¡Œä¾èµ–ä¸‹è½½
    ```js
        npm install
        // æˆ–
        yarn
    ```
7. ä¸‹è½½ä¾èµ–
    ```js
    // npm æˆ– yarn
    
    npm install simple-keyboard
    
    // è¡¥å……: å› ä¸ºçº¿ä¸Šé¡¹ç›®ä½¿ç”¨çš„æŠ€æœ¯æ ˆæ˜¯Vue3+element-plus,æ‰€ä»¥è¿™é‡Œè¿˜éœ€è¦ä¸‹è½½ä¸€ä¸ªelement-plus
    npm install element-plus
    ```
8. main.jså¤„ç†
    ```js
    import { createApp } from 'vue';
    import App from './App.vue';
    import './assets/styles/index.scss';
    import './assets/styles/bootstrap.css';
    import 'simple-keyboard/build/css/index.css';
    import directive from '@/directives/index';
    import ElementPlus from 'element-plus';
    import 'element-plus/dist/index.css';
    import { components } from './components/index';

    const app = createApp(App);

    // å…¨å±€ç»„ä»¶æŒ‚è½½
    components(app);

    app.use(directive).use(ElementPlus).mount('#app');
    ```
9. å¯¼å…¥ä¹‹å‰è‡ªå·±äºŒæ¬¡å°è£…çš„element-plusçš„å¼¹çª—ç»„ä»¶(è¿™ä¸ªç»„ä»¶åç»­ä¼šè¿›è¡Œåˆ†äº«,ä½¿ç”¨èµ·æ¥è¿˜æ˜¯å¾ˆç®€å•çš„ğŸ™ƒ)
    ```js
    // é¡¹ç›®çš„srcç›®å½•ä¸‹æ–°å»ºcomponentsæ–‡ä»¶å¤¹()
    
    // src/components/index.js
    // äºŒæ¬¡å°è£…çš„å¼¹æ¡†ç»„ä»¶
    import DialogModal from './DialogModal/index.vue';
    // è™šæ‹Ÿé”®ç›˜ç»„ä»¶
    import Keyboard from './Keyboard/index.vue';

    // å…¨å±€æ–¹æ³•æŒ‚è½½
    export function components(app) {
      app.component('Keyboard', Keyboard);
      app.component('DialogModal', DialogModal);
    }
    ```
 ## ğŸ¤¨3. å¼€å§‹å¼€å‘
 1. é¦–å…ˆåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿé”®ç›˜å‡ºæ¥,å³ä½¿æ²¡æœ‰è‡ªå®šä¹‰æŒ‡ä»¤è§¦å‘,è™šæ‹Ÿé”®ç›˜ä¹Ÿå¯ä»¥æ§åˆ¶å¼¹å‡ºéšè—
    ```js
    <template>
       <!-- DialogModalå°±æ˜¯äºŒæ¬¡å°è£…çš„å¼¹æ¡†ç»„ä»¶,åœ¨å‰é¢å·²ç»è¿›è¡Œå…¨å±€å¯¼å…¥äº†,æ‰€ä»¥è¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨ -->
      <DialogModal :title="''" ref="dialogModalRef" @close="close">
        <template #text="{ row }">
          <!-- <el-button @click="openModal(row)">æ‰“å¼€å¼¹æ¡†</el-button> -->
          <span></span>
        </template>
        <template #body>
          <div class="form-floating">
            <textarea class="form-control input" placeholder="è¾“å…¥åŒºåŸŸ" id="textarea" style="height: 100px"></textarea>
            <label for="textarea">è¾“å…¥åŒºåŸŸ</label>
          </div>

          <!-- é”®ç›˜1 -->
          <div class="letter show">
            <div class="simple-keyboard-main"></div>
          </div>

          <!-- é”®ç›˜2 -->
          <div class="fn">
            <div class="select-box left-select"></div>
            <div class="simple-keyboard-main2"></div>
            <div class="select-box right-select"></div>
          </div>
        </template>

        <template #footer>
          <span></span>
        </template>
      </DialogModal>
      <div class="modal fade" id="keyboardModal" tabindex="-1" aria-labelledby="textarea" aria-hidden="true"></div>
    </template>

    <script setup>
    // è™šæ‹Ÿé”®ç›˜ç¬¬ä¸‰æ–¹åº“
    import SimpleKeyboard from 'simple-keyboard';
    import { ref, nextTick } from 'vue';

    // å¼¹æ¡†å®ä¾‹
    const dialogModalRef = ref();

    // è‡ªå®šä¹‰é”®ç›˜æ–‡æœ¬åŸŸ
    let textBox = '';

    /**
     * é”®ç›˜
     */
    let commonKeyboardOptions = {
      onKeyPress: button => onKeyPress(button),
      theme: 'simple-keyboard hg-theme-default',
      physicalKeyboardHighlight: true,
      syncInstanceInputs: true,
      mergeDisplay: true,
    };
    let keyboard = '';

    function handleShift() {
      let currentLayout = keyboard.options.layoutName;
      let shiftToggle = currentLayout === 'default' ? 'shift' : 'default';

      keyboard.setOptions({
        layoutName: shiftToggle,
      });
    }
    // åˆ‡æ¢é”®ç›˜
    function handleSwitch(button) {
      console.log(button);
      nextTick(() => {
        if (button === '{f(x)}') {
          document.querySelector('.fn').classList.add('show');
          document.querySelector('.letter').classList.remove('show');
        } else if (button === '{ABC}') {
          document.querySelector('.letter').classList.add('show');
          document.querySelector('.fn').classList.remove('show');
        }
      });
    }
    // ç‚¹å‡»enteræäº¤
    function handleSubmit(button) {
      dialogModalRef.value.dialog.visible = false;

      // TODO: ä»¥ä¸‹ä»£ç åˆ†åˆ«ä¸ºä¿®æ”¹inputæ¡†çš„valueä»¥åŠè°ƒç”¨inputçš„changäº‹ä»¶,ä¸ºv-modelçš„æ ¸å¿ƒæ–¹æ³•,ä¸¤ä¸ªéƒ½è§¦å‘æ‰§è¡Œ,å°±æ˜¯è§¦å‘äº†v-model,æ‰€ä»¥v-modelçš„ä¹Ÿä¼šè¢«ä¿®æ”¹

      // å°†å†™å‡ºç»“æœå†…å®¹æ·»åŠ åˆ°å…¨å±€çš„
      window.targetInput.value = textBox.value;

      // è§¦å‘inputäº‹ä»¶ï¼Œä»¥æ›´æ–°v-modelç»‘å®šçš„å˜é‡
      window.targetInput.dispatchEvent(new Event('input')); 
    }
    function handleEsc() {
      dialogModalRef.value.dialog.visible = false;
    }
    function getButtonValue(button) {
      if (button === '{True(HI)}') button = '{True}';
      if (button === '{False(LO)}') button = '{False}';
      let arr = ['{True}', '{False}', '{and}', '{or}', '{not}', '{xor}'];
      if (arr.includes(button)) {
        return button.slice(1, button.length - 1);
      } else if (button === '{space}') {
        return ' ';
      } else if (button.includes('numpad')) {
        return button.slice(7, button.length - 1);
      } else {
        return button;
      }
    }
    function onKeyPress(button) {
      if (button === '{escape}') {
        handleEsc();
        return;
      }
      if (button === '{enter}') {
        handleSubmit(button);
        return;
      }
      if (button === '{shift}' || button === '{shiftleft}' || button === '{shiftright}' || button === '{capslock}') {
        handleShift();
        return;
      }

      if (button === '{backspace}') {
        // è·å–å…‰æ ‡ä½ç½®
        let cursorPosition = textBox.selectionStart;
        // è·å–æ–‡æœ¬æ¡†ä¸­çš„å€¼
        let value = textBox.value;
        let newValue = removeCharAtIndex(value, cursorPosition - 1);

        textBox.value = newValue;
        keyboard.setInput(newValue);

        moveCursor(cursorPosition, -1);
      } else if (button === '{f(x)}' || button === '{ABC}') {
        handleSwitch(button);
      } else if (button === '{arrowleft}' || button === '{arrowright}') {
        let offset = button === '{arrowleft}' ? -1 : 1;
        let currentPosition = textBox.selectionStart;
        let newPosition = currentPosition + offset;
        textBox.setSelectionRange(newPosition, newPosition);
      } else {
        // è·å–å…‰æ ‡ä½ç½®
        let cursorPosition = textBox.selectionStart;
        // è·å–æ–‡æœ¬æ¡†ä¸­çš„å€¼
        let value = textBox.value;
        // è¾“å…¥çš„é”®ç›˜å€¼
        let buttonValue = getButtonValue(button);
        // åœ¨å…‰æ ‡ä½ç½®æ’å…¥å€¼
        let newValue = insertString(value, cursorPosition, buttonValue);

        textBox.value = newValue;
        keyboard.setInput(newValue);

        moveCursor(cursorPosition, buttonValue.length);
      }

      // å°†focusæ“ä½œåŠ å…¥å»¶æ—¶é˜Ÿåˆ—
      setTimeout(() => {
        textBox.focus();
      }, 0);
    }
    // åœ¨æŒ‡å®šä½ç½®æ’å…¥å­—ç¬¦ä¸²
    function insertString(originalString, index, insertion) {
      return originalString.slice(0, index) + insertion + originalString.slice(index);
    }
    // ç§»é™¤æŒ‡å®šä½ç½®çš„å­—ç¬¦ä¸²
    function removeCharAtIndex(inputString, index) {
      return inputString.slice(0, index) + inputString.slice(index + 1);
    }
    // å°†å…‰æ ‡ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®
    function moveCursor(currentPosition, offset) {
      let newPosition = currentPosition + offset; // è®¡ç®—æ–°çš„å…‰æ ‡ä½ç½®
      textBox.setSelectionRange(newPosition, newPosition); // ç§»åŠ¨å…‰æ ‡
    }

    /**
     * ä¸‹æ‹‰é€‰æ‹©
     */
    let selectOptions = {
      onChange: function (event) {
        console.log(event);
      },
    };
    let selectList = [
      {
        title: 'é€‰æ‹©è®¾å¤‡',
        options: [
          { value: '', label: '--' },
          { value: '1', label: 'è®¾å¤‡1' },
          { value: '2', label: 'è®¾å¤‡2' },
        ],
      },
      {
        title: 'è·å–æ‰€é€‰å‚æ•°å€¼',
        options: [
          { value: '', label: '--' },
          { value: '1', label: 'å‚æ•°å€¼1' },
          { value: '2', label: 'å‚æ•°å€¼2' },
        ],
      },
    ];
    async function createSelect(item, selectOptions) {
      await nextTick();
      let selectDom = document.createElement('select');
      selectDom.classList.add('form-select');
      selectDom.setAttribute('data-title', item.title);
      selectDom.onchange = selectOptions.onChange;

      for (let i = 0; i < item.options.length; i++) {
        let optionDom = document.createElement('option');
        optionDom.value = item.options[i].value;
        optionDom.textContent = item.options[i].label;
        selectDom.appendChild(optionDom);
      }
      return selectDom;
    }
    async function renderSelectList(parentDom, selectList, selectOptions) {
      await nextTick();

      let fragment = document.createDocumentFragment();

      for (let i = 0; i < selectList.length; i++) {
        let itemDom = document.createElement('div');
        itemDom.classList.add('item');

        let div = document.createElement('div');
        div.textContent = selectList[i].title;
        itemDom.appendChild(div);

        let selectDom = await createSelect(selectList[i], selectOptions);
        itemDom.appendChild(selectDom);

        fragment.appendChild(itemDom);
      }

      parentDom.appendChild(fragment);
    }

    // æ‰“å¼€é”®ç›˜å¼¹æ¡†
    const openModal = value => {
      // æ‰“å¼€å¼¹æ¡†
      dialogModalRef.value.dialog.visible = true;

      // åˆ›å»ºé”®ç›˜
      nextTick(() => {
        textBox = document.getElementById('textarea');

        if (value && textBox) {
          textBox.value = value;
        }

        keyboard = new SimpleKeyboard('.simple-keyboard-main', {
          ...commonKeyboardOptions,
          layout: {
            default: ['{escape} 1 2 3 4 5 6 7 8 9 0 - = {backspace}', 'q w e r t y u i o p [ ] \\', "{capslock} a s d f g h j k l ; ' {enter}", 'z x c v b n m , . /', '{f(x)} {shiftleft} {space} {arrowleft} {arrowright}'],
            shift: ['{escape} ! @ # $ % ^ & * ( ) _ + {backspace}', 'Q W E R T Y U I O P { } |', '{capslock} A S D F G H J K L : " {enter}', 'Z X C V B N M < > ?', '{f(x)} {shiftleft} {space} {arrowleft} {arrowright}'],
          },
          display: {
            '{escape}': 'esc â‹',
            '{tab}': 'tab â‡¥',
            '{backspace}': 'backspace âŒ«',
            '{enter}': 'æäº¤ â†µ',
            '{capslock}': 'caps lock â‡ª',
            '{shiftleft}': 'shift â‡§',
            '{arrowup}': 'ä¸Š',
            '{arrowdown}': 'ä¸‹',
            '{arrowleft}': 'å·¦',
            '{arrowright}': 'å³',
            '{f(x)}': 'f(x)',
          },
        });

        new SimpleKeyboard('.simple-keyboard-main2', {
          ...commonKeyboardOptions,
          layout: {
            default: ['{True(HI)} {False(LO)} {escape} {backspace}', '{and} {or} {not} {xor} ( ) {numpad7} {numpad8} {numpad9}', '< > = ~= >= <= {numpad4} {numpad5} {numpad6}', '+ - * / % ^ {numpad1} {numpad2} {numpad3}', '" \' {space} {numpad0} , .', '{ABC} {enter} {arrowleft} {arrowright}'],
          },
          display: {
            '{escape}': 'esc â‹',
            '{backspace}': 'backspace âŒ«',
            '{enter}': 'æäº¤ â†µ',
            '{ABC}': 'ABC',
            '{True(HI)}': 'True(HI)',
            '{False(LO)}': 'False(LO)',
            '{and}': 'and',
            '{or}': 'or',
            '{not}': 'not',
            '{xor}': 'xor',
            '{arrowleft}': 'â†',
            '{arrowright}': 'â†’',
          },
        });

        renderSelectList(document.querySelector('.left-select'), selectList, selectOptions);
        renderSelectList(document.querySelector('.right-select'), selectList, selectOptions);
      });
    };

    // å…³é—­å¼¹æ¡†å›è°ƒ
    const close = () => {
      window.isFocus = false;
    };

    // TODO: æ‰“å¼€é”®ç›˜å¼¹æ¡†æ–¹æ³•æŒ‚è½½å…¨å±€(è¿™é‡Œæ˜¯ä¸ºäº†å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹æ‰“å¼€è™šæ‹Ÿé”®ç›˜å¼¹æ¡†,ä¾‹å¦‚è‡ªå®šä¹‰æŒ‡ä»¤æ§åˆ¶)
    window.Keyboard.openModal = openModal;
    </script>

    <style scoped>
    input {
      font-size: 20px;
    }

    /* .modal {
      --bs-modal-width: 1100px;
    } */

    .fn,
    .letter {
      display: none;
      margin: 10px 0 0;
      background-color: #ececec;
    }

    div.show {
      display: flex;
    }

    .fn .select-box {
      padding: 0 10px 5px;
      width: 230px;
    }
    .fn .select-box .item {
      margin-top: 10px;
    }

    /* é‡ç½®é”®ç›˜ç›’å­æ ·å¼ */
    .hg-theme-default {
      width: unset;
      flex: 1;
    }

    /* é‡ç½®æŒ‡å®šé”®ç›˜1çš„æ ·å¼ */
    .simple-keyboard-main {
      --key-width: 63px;
      --margin-width: 5px;

      --longer-key-width: calc(var(--key-width) * 2 + var(--margin-width));
      --space-key-width: calc(var(--key-width) * 7 + var(--margin-width) * 6);
    }

    .simple-keyboard-main .hg-row .hg-button {
      flex-grow: 0;
      height: var(--key-width);
      width: var(--key-width);
    }
    .simple-keyboard-main .hg-row {
      justify-content: center;
    }

    .simple-keyboard-main .hg-row .hg-button[data-skbtn='{escape}'] {
      width: var(--longer-key-width);
    }
    .simple-keyboard-main .hg-row .hg-button[data-skbtn='{backspace}'] {
      width: var(--longer-key-width);
    }
    .simple-keyboard-main .hg-row .hg-button[data-skbtn='{capslock}'] {
      width: var(--longer-key-width);
    }
    .simple-keyboard-main .hg-row .hg-button[data-skbtn='{enter}'] {
      width: var(--longer-key-width);
    }
    .simple-keyboard-main .hg-row .hg-button[data-skbtn='{shiftleft}'] {
      width: var(--longer-key-width);
    }
    .simple-keyboard-main .hg-row .hg-button[data-skbtn='{space}'] {
      width: var(--space-key-width);
    }

    /* é‡ç½®æŒ‡å®šé”®ç›˜1çš„æ ·å¼ */
    .simple-keyboard-main2 {
      --key-width: 63px;
      --margin-width: 5px;

      --longer-key-width: calc(var(--key-width) * 2 + var(--margin-width));
      --backspace-key-width: calc(var(--key-width) * 3 + var(--margin-width) * 2);
      --enter-key-width: calc(var(--key-width) * 5 + var(--margin-width) * 4);
      --space-key-width: calc(var(--key-width) * 4 + var(--margin-width) * 3);
    }
    .simple-keyboard-main2 .hg-row .hg-button {
      flex-grow: 0;
      height: var(--key-width);
      width: var(--key-width);
    }
    .simple-keyboard-main2 .hg-row {
      justify-content: center;
    }

    .simple-keyboard-main2 .hg-row .hg-button[data-skbtn='{True(HI)}'] {
      width: var(--longer-key-width);
    }
    .simple-keyboard-main2 .hg-row .hg-button[data-skbtn='{False(LO)}'] {
      width: var(--longer-key-width);
    }
    .simple-keyboard-main2 .hg-row .hg-button[data-skbtn='{escape}'] {
      width: var(--longer-key-width);
    }
    .simple-keyboard-main2 .hg-row .hg-button[data-skbtn='{backspace}'] {
      width: var(--backspace-key-width);
    }
    .simple-keyboard-main2 .hg-row .hg-button[data-skbtn='ABC'] {
      width: var(--longer-key-width);
    }
    .simple-keyboard-main2 .hg-row .hg-button[data-skbtn='{enter}'] {
      width: var(--enter-key-width);
    }
    .simple-keyboard-main2 .hg-row .hg-button[data-skbtn='{space}'] {
      width: var(--space-key-width);
    }
    </style>
    ```
 2. å¼€å‘è‡ªå®šä¹‰æŒ‡ä»¤
     1. è‡ªå®šä¹‰æŒ‡ä»¤çš„API
     ```js
        åœ¨ç»‘å®šå…ƒç´ çš„ attribute æˆ–äº‹ä»¶ç›‘å¬å™¨è¢«åº”ç”¨ä¹‹å‰è°ƒç”¨, åœ¨æŒ‡ä»¤éœ€è¦é™„åŠ é¡»è¦åœ¨æ™®é€šçš„ v-on äº‹ä»¶ç›‘å¬å™¨å‰è°ƒç”¨çš„äº‹ä»¶ç›‘å¬å™¨æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨
        created() { },
        å½“æŒ‡ä»¤ç¬¬ä¸€æ¬¡ç»‘å®šåˆ°å…ƒç´ å¹¶ä¸”åœ¨æŒ‚è½½çˆ¶ç»„ä»¶ä¹‹å‰è°ƒç”¨
        beforeMount() { },
        åœ¨ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶è¢«æŒ‚è½½åè°ƒç”¨
        mounted() { },
        åœ¨æ›´æ–°åŒ…å«ç»„ä»¶çš„ VNode ä¹‹å‰è°ƒç”¨
        beforeUpdate() { },
        åœ¨åŒ…å«ç»„ä»¶çš„ VNode åŠå…¶å­ç»„ä»¶çš„ VNode æ›´æ–°åè°ƒç”¨
        updated() { },
        åœ¨å¸è½½ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶ä¹‹å‰è°ƒç”¨
        beforeUnmount() { },
        å½“æŒ‡ä»¤ä¸å…ƒç´ è§£é™¤ç»‘å®šä¸”çˆ¶ç»„ä»¶å·²å¸è½½æ—¶, åªè°ƒç”¨ä¸€æ¬¡
        unmounted() { },
     ```
     
     2. å°†è‡ªå®šä¹‰æŒ‡ä»¤ä¸è™šæ‹Ÿé”®ç›˜å¼¹æ¡†ç»“åˆ
     ```js
    // /src/directives/index.js
    
    import { nextTick } from 'vue';
    import Keyboard from '@/components/Keyboard/index';
    /**
     * é€’å½’æŸ¥æ‰¾inputå…ƒç´ 
     * @param {object} dom domæ ‘
     * @returns æ‰¾åˆ°çš„inputå…ƒç´ æˆ–è€…null
     */
    function findFirstInputElement(dom) {
      // æ£€æŸ¥domæ˜¯å¦æ˜¯inputå…ƒç´ 
      if (dom.tagName === 'INPUT') {
        return dom;
      }

      // å¦‚æœä¸æ˜¯inputå…ƒç´ ï¼Œä¸”æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™é€’å½’æŸ¥æ‰¾å­èŠ‚ç‚¹
      if (dom.children) {
        for (let child of dom.children) {
          let input = findFirstInputElement(child);
          if (input) {
            return input; // å¦‚æœæ‰¾åˆ°inputå…ƒç´ ï¼Œç«‹å³è¿”å›
          }
        }
      }
      // å¦‚æœæ²¡æœ‰æ‰¾åˆ°inputå…ƒç´ ï¼Œè¿”å›null
      return null;
    }

    export default {
      install(app) {
        app.directive('keyboard', {
          mounted(el, binding) {
            // è·å–éœ€è¦ç›‘å¬èšç„¦çš„input
            let input = findFirstInputElement(el);

            // è¾¹ç•Œå¤„ç†åˆ¤æ–­
            if (input === null) return console.log('æ²¡æœ‰è¦èšç„¦çš„input');

            // ç»‘å®šæŒ‡ä»¤çš„inputå–æ¶ˆèšç„¦
            input.blur();

            // åˆ¤æ–­æ˜¯å¦å·²ç»è·å–ç„¦ç‚¹
            window.isFocus = false;

            // æ‰“å¼€é”®ç›˜æ–¹æ³•
            const { openModal } = window.Keyboard;

            // èšç„¦äº‹ä»¶å‡½æ•°
            const focusFn = () => {
              // å¦‚æœå·²ç»è·å–è¿‡ç„¦ç‚¹,å¹¶ä¸”æ²¡æœ‰å–æ¶ˆç„¦ç‚¹,åˆ™ä¸å…è®¸åç»­ä»£ç è¿è¡Œ
              if (window.isFocus) return;

              // è®¾ç½®å·²è·å–ç„¦ç‚¹
              window.isFocus = true;

              // æ‰“å¼€é”®ç›˜å¼¹æ¡†
              openModal && openModal(input.value);

              // è®¾ç½®å…¨å±€å½“å‰è§¦å‘æŒ‡ä»¤çš„input
              window.targetInput = input
            };

            // ç»‘å®šè¡¨å•èšç„¦äº‹ä»¶
            input.onfocus = focusFn;

            // æ¯æ¬¡å–æ¶ˆèšç„¦æ—¶,éƒ½é‡æ–°ç›‘å¬èšç„¦å‡½æ•°,å°†ä¹‹å‰çš„èšç„¦å‡½æ•°è¦†ç›–
            input.onblur = () => {
              input.onfocus = focusFn;
            };
          },
          beforeUnmount(el) {
            console.log('è§¦å‘beforeUnmount');
            el.onfocus = () => {};
            el.onblur = () => {};
          },
        });
      },
    };
    ```
    
  ## ğŸ¤—4. æµ‹è¯•ä¸€ä¸‹
  ```js
  <template>
  <div>
    <el-input v-model="a" v-keyboard />
    <el-input v-model="b" v-keyboard />
    <el-input v-model="c" v-keyboard />
    <el-input v-model="d" v-keyboard />
    <Keyboard></Keyboard>
  </div>
</template>

<script setup>
import { ref } from 'vue';

let a = ref(1);
let b = ref(2);
let c = ref(3);
let d = ref(4);
</script>

<style lang="scss" scoped></style>
  ```
åœ¨App.vueä¸­ä½¿ç”¨ä»¥ä¸Šä»£ç ,å½“æŸä¸ªè¡¨å•èšç„¦æ—¶,å°±ä¼šå¼¹å‡ºè™šæ‹Ÿé”®ç›˜å¼¹æ¡†
![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58145e3ac89d4215b0c80a099a1b115c~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1920&h=911&s=68841&e=png&b=7f7f7f)

å¹¶ä¸”è™šæ‹Ÿé”®ç›˜å¼¹æ¡†ä¸­ä¹Ÿä¼šæœ‰è¿™ä¸ªè¡¨å•çš„valueå€¼,åœ¨å¼¹å‡ºçš„è™šæ‹Ÿé”®ç›˜ä¸­å¯¹è¡¨å•çš„å€¼è¿›è¡Œä¿®æ”¹,å¹¶ç‚¹å‡»æäº¤,å°±ä¼šå‘ç°å¯¹åº”çš„è¡¨å•çš„å€¼è¢«ä¿®æ”¹äº†
![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2b421d5f8d4c4cd2bd0e2e06704d39d8~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=473&h=180&s=3108&e=png&b=ffffff)

è‡³æ­¤,ä½¿ç”¨è‡ªå®šä¹‰æŒ‡ä»¤+å°è£…ç»„ä»¶å®ç°çš„è™šæ‹Ÿé”®ç›˜åŠŸèƒ½å°±å®Œæˆäº†


## ğŸ¥±5. ä¸­é—´é‡åˆ°çš„éš¾ç‚¹ä»¥åŠå¦‚ä½•è§£å†³çš„
1. å¦‚ä½•ä¿®æ”¹å½“å‰v-modelç»‘å®šçš„å€¼å‘¢?

    è¿™ä¸ªé—®é¢˜å›°æ‰°äº†æˆ‘ä¸å°‘æ—¶é—´,å› ä¸ºä¹‹å‰é™·å…¥äº†æ€ç»´è¯¯åŒº,å…‰æƒ³ç€å°†v-modelç»‘å®šçš„å€¼ä¼ é€’ç»™è‡ªå®šä¹‰æŒ‡ä»¤ä¸­,ç„¶åè‡ªå®šä¹‰æŒ‡ä»¤å†è¿›è¡Œå¤„ç†ç­‰ç­‰,ä½†æ˜¯å®åœ¨æ˜¯å¤ªéº»çƒ¦. 
    
    åˆšå¥½çªç„¶æƒ³åˆ°äº†v-modelçš„åŸç†,å°±æ˜¯ç›‘å¬è¡¨å•çš„changeä¸inputäº‹ä»¶,æ‰€ä»¥æˆ‘åªéœ€è¦å°†æ–°çš„å€¼æ”¾åˆ°è¿™ä¸ªè¡¨å•çš„valueä¸­,ç„¶åæ‰‹åŠ¨è§¦å‘changeä¸inputæ–¹æ³•å°±è¡Œäº†!

2. å¦‚ä½•å…¼å®¹ä¸åŒçš„ç»„ä»¶åº“
   
    åœ¨åˆšå¼€å§‹åšè¿™ä¸ªåŠŸèƒ½çš„æ—¶å€™æˆ‘å°±æƒ³åˆ°äº†,å¼€å‘æ—¶æ˜¯è‚¯å®šä¸ä¼šå†™åŸç”Ÿçš„inputçš„,å¦‚æœæ˜¯ä¸€äº›ç»„ä»¶åº“åº”è¯¥æ€ä¹ˆåŠ,æ€»ä¸å¯èƒ½ç»„ä»¶å†™åˆ°ç»„ä»¶åº“ä¸­çš„inputé‡Œé¢å§,è‚¯å®šæ˜¯å†™åœ¨v-modelçš„ç»Ÿä¸€æ ‡ç­¾ä¸­çš„
    
    äºæ˜¯,æˆ‘å°±å»çœ‹element-plusé‡Œé¢çš„el-inputçš„ç»“æ„,å‘ç°æœ€æ·±å±‚ä¾ç„¶å­˜åœ¨input,äºæ˜¯å°±å†™äº†ä¸€ä¸ªè¾…åŠ©æ–¹æ³•,å¯ä»¥åˆ¤æ–­å½“å‰æŒ‡ä»¤ç»‘å®šçš„domæ˜¯å¦ä¸ºinputå…ƒç´ ,å¦‚æœå½“å‰è‡ªå®šä¹‰æŒ‡ä»¤å°±æ˜¯ç»‘å®šåœ¨inputå…ƒç´ ä¸Š,å°±ä¸éœ€è¦å†è¿›è¡Œå¤„ç†äº†,å¦‚æœä¸æ˜¯,å°±è¿›è¡Œé€’å½’æ“ä½œ,å‘æ›´æ·±å±‚æ¬¡å»æŸ¥æ‰¾
    
    å°†æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªinputå…ƒç´ ä½œä¸ºå¤„ç†çš„å…ƒç´ ,åœ¨åç»­çš„å¼¹æ¡†è™šæ‹Ÿé”®ç›˜ä¸­è¾“å…¥çš„å€¼ä½œä¸ºvalueæ›¿æ¢åˆ°è¿™ä¸ªinputçš„valueä¸­,å†è°ƒç”¨è¿™ä¸ªinputçš„changeä¸inputæ–¹æ³•å³å¯å®ç°åœ¨ä¸åŒçš„ç»„ä»¶åº“ä¸­,åªéœ€è¦ç»‘å®šè¿™ä¸ªè‡ªå®šä¹‰æŒ‡ä»¤,éƒ½å¯ä»¥å…¼å®¹

## ğŸ‰6. æ€»ç»“
ä¸ªäººæ„Ÿè§‰æ˜¯éå¸¸é”»ç‚¼Vueçš„ä¸€ä¸ªå°åŠŸèƒ½, å¦‚æœéœ€è¦æºç çš„å¯ä»¥æ˜é‡‘/csdn (éƒ½æ˜¯åŒåçš„),ç§ä¿¡æˆ‘è·å–æºç 
![å°çŒ«å’ªæ‘‡é¥®æ–™.gif](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ba865a424e54dd5aa110b351702a30f~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=142&h=142&s=21579&e=gif&f=4&b=fddcce)