# ä¼˜åŒ–Threejsçš„åæ ‡è¾…åŠ©çº¿,é€‚ç”¨äºæ›´å¤šåœºæ™¯

## 1. å‰è¨€
ç›¸ä¿¡æœ‰ä¸å°‘å¼€å‘è€…éƒ½æ˜¯ç”¨è¿‡Threejsè‡ªå¸¦çš„åæ ‡è¾…åŠ©çº¿,ç”¨èµ·æ¥éå¸¸ç®€å•,ä½†æ˜¯æ‹“å±•èµ·æ¥è¾ƒä¸ºéº»çƒ¦,åªèƒ½æŒ‡å®šè¾…åŠ©çº¿çš„é•¿åº¦,å…¶ä»–çš„æ“ä½œä½¿ç”¨èµ·æ¥éå¸¸éº»çƒ¦,æ‰€ä»¥æˆ‘å°±æƒ³,èƒ½ä¸èƒ½å°è£…ä¸€ä¸ªçœ‹èµ·æ¥æ›´èˆ’æœçš„åæ ‡è¾…åŠ©çº¿åŒæ—¶å¯ä»¥æ›´æ–¹ä¾¿çš„æŒ‡å®šè¾…åŠ©çº¿çš„é•¿åº¦,ç²—ç»†ç­‰ä¿¡æ¯

**threejsæœ¬èº«è‡ªå¸¦çš„è¾…åŠ©çº¿:**
![threejsæœ¬èº«è‡ªå¸¦çš„è¾…åŠ©çº¿](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48979d626dd2485a84a89be423a52893~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1920&h=911&s=26838&e=png&b=000000)

**ä¼˜åŒ–åçš„è¾…åŠ©çº¿:ä¸ä»…å¯ä»¥è‡ªå®šä¹‰å„ä¸ªæ–¹å‘çš„é¢œè‰²,ä¹Ÿå¯ä»¥è°ƒæ•´è¾…åŠ©çº¿çš„ç²—ç»†,é•¿åº¦ç­‰ç­‰** 
![ä¼˜åŒ–åçš„è¾…åŠ©çº¿](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c4afc70a222342b0baf96d72b70421b8~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1920&h=911&s=25901&e=png&b=000000)

## 2. åŸç†
ä¼˜åŒ–åçš„åæ ‡è¾…åŠ©çº¿ä¸»è¦ç”±ä»¥ä¸‹æ–¹æ³•æ„æˆ

```js
/**
 * æ·»åŠ xyzä¸‰è‰²è¾…åŠ©çº¿
 * @param {Object} model éœ€è¦æ·»åŠ è¾…åŠ©çº¿çš„THREE.Object3D
 * @param {Number} thickness çº¿æ¡çš„é•¿åº¦
 * @param {Number} height çº¿æ¡çš„é«˜åº¦
 */
function addAxesHelper(model, thickness, height) {
  // è®¾ç½®ä¸‰ä¸ªæ–¹å‘çš„åœ†é”¥+åœ†é”¥,å½¢æˆåæ ‡è¾…åŠ©çº¿
  const axesHelperArr = [
    {
      color: '#00FFB5',
      direction: 'x',
      cylinderDirection: 'z',
      goneDirection: 'y',
      angle: -Math.PI / 2,
    },
    {
      color: '#2F88FE',
      direction: 'y',
      cylinderDirection: 'y',
      goneDirection: 'y',
      angle: -Math.PI / 2,
    },
    {
      color: '#F86C55',
      direction: 'z',
      cylinderDirection: 'x',
      goneDirection: 'y',
      angle: Math.PI / 2,
    },
  ];

  // å¾ªç¯æ–¹å‘æ•°ç»„
  for (let i = 0; i < axesHelperArr.length; i++) {
    // è·å–å„ä¸ªæ–¹å‘çš„é¢œè‰²,æ–¹å‘å€¼,æ—‹è½¬æ–¹å‘,æ—‹è½¬è§’åº¦,åœ†é”¥æŒ‡ç¤ºæ–¹å‘
    const { color, direction, cylinderDirection, goneDirection, angle } = axesHelperArr[i];
    // é»˜è®¤ç²—ç»†ç¼©å°100å€
    const crude = thickness / 100;

    // åˆ›å»ºåœ†æŸ±å‡ ä½•ä½“
    const geometryCylinder = new THREE.CylinderGeometry(crude, crude, height, 32);
    // åˆ›å»ºåœ†æŸ±æè´¨
    const materialCylinder = new THREE.MeshBasicMaterial({ color });
    // ç”Ÿæˆåœ†æŸ±ç‰©ä½“
    const meshCylinder = new THREE.Mesh(geometryCylinder, materialCylinder);
    // è®¾ç½®åœ†æŸ±ç‰©ä½“é»˜è®¤çš„æ—‹è½¬æ–¹å‘ä¸‹çš„æŒ‡å®šæ—‹è½¬è§’åº¦
    meshCylinder.rotation[cylinderDirection] = angle;
    // å°†åœ†æŸ±çš„åº•éƒ¨å¯¹å‡†ä¸­å¿ƒç‚¹
    meshCylinder.position[direction] = height / 2;

    // åˆ›å»ºåœ†é”¥å‡ ä½•ä½“
    const geometryCone = new THREE.ConeGeometry(crude * 2, 0.05, 32);
    // åˆ›å»ºåœ†é”¥æè´¨
    const materialCone = new THREE.MeshBasicMaterial({ color });
    // ç”Ÿæˆåœ†é”¥ç‰©ä½“
    const meshCone = new THREE.Mesh(geometryCone, materialCone);
    // è®¾ç½®åœ†é”¥ä½ç½®ä¸ºåœ†é”¥çš„åº•éƒ¨
    meshCone.position[goneDirection] = height / 2;

    // åœ†é”¥æ·»åŠ åˆ°åœ†æŸ±ä¸­
    meshCylinder.add(meshCone);

    // åœ†æŸ±+åœ†é”¥çš„ç®­å¤´ç»„åˆæ·»åŠ åˆ°æŒ‡å®šçš„Object3Då¯¹è±¡ä¸­
    model.add(meshCylinder);
  }
}
```
å¦‚ä»¥ä¸Šä»£ç æ‰€ç¤º,ä¼ å…¥ä¸€ä¸ªéœ€è¦æ·»åŠ è¾…åŠ©çº¿çš„æ¨¡å‹,é€šçŸ¥æŒ‡å®šçº¿æ¡çš„ç²—ç»†ä»¥åŠé•¿åº¦å³å¯,å¦‚æœæ²¡æœ‰æŒ‡å®š,ä¹Ÿæœ‰é»˜è®¤çš„é•¿åº¦ä»¥åŠç²—ç»†,å¹¶ä¸”å†…ç½®äº†å„ä¸ªåæ ‡æ–¹å‘çš„é¢œè‰²

### è§£é‡Š:
1. ä¼˜åŒ–åçš„åæ ‡è¾…åŠ©çº¿æœ¬è´¨ä¸Šæ˜¯ç”±ä¸€ä¸ªåœ†æŸ±ä½“ä¸åœ†é”¥ä½“ç»„æˆçš„
2. å°†åœ†æŸ±ä½“ä¸åœ†é”¥ä½“ç»„æˆä¸€ä¸ªç®­å¤´,é€šè¿‡å†…ç½®çš„è§’åº¦æ•°æ®ä»¥åŠæŒ‡å®šå„ä¸ªè¾…åŠ©çº¿å¯¹åº”çš„æ–¹å‘,å°†å…¶æ·»åŠ åˆ°æ¨¡å‹ä¸­å³å¯

## 3. ä½¿ç”¨å®ä¾‹(æ•´ä½“ä»£ç ):
```js
<!--
 * @Author: wangzhiyu <w19165802736@163.com>
 * @version: 1.0.0
 * @Date: 2024-03-12 16:30:13
 * @LastEditTime: 2024-05-30 13:31:15
 * @Descripttion: Threejsè‡ªå®šä¹‰è¾…åŠ©çº¿
-->
<template></template>

<script setup>
import { onMounted } from 'vue';
// å¯¼å…¥threejs
import * as THREE from 'three';
// å¯¼å…¥è½¨é“æ§åˆ¶å™¨
import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

// åˆå§‹åŒ–åœºæ™¯,ç›¸æœº,æ¸²æŸ“å™¨
const scene = new THREE.Scene();
// THREE.PerspectiveCamera(æ‘„åƒæœºå‚ç›´è§’åº¦, æ‘„åƒæœºå®½é«˜æ¯”,æ‘„åƒæœºè¿‘ç«¯é¢,æ‘„åƒæœºè¿œç«¯é¢);
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 5000);
// è®¾ç½®æ‘„åƒæœºçš„ä½ç½®
camera.position.set(2.5, 1.51, 1.02);
// æ‘„åƒæœºæ·»åŠ åˆ°åœºæ™¯ä¸­
scene.add(camera);
// æ¸²æŸ“å™¨
const renderer = new THREE.WebGL1Renderer({ antialias: true });
// è®¾ç½®æ¸²æŸ“å™¨å°ºå¯¸
renderer.setSize(window.innerWidth, window.innerHeight);

// åˆ›å»ºè½¨é“æ§åˆ¶å™¨
const controls = new OrbitControls(camera, renderer.domElement);
// å¼€å¯é˜»å°¼æ•ˆæœ
controls.enableDamping = true;

/**
 * æ·»åŠ xyzä¸‰è‰²è¾…åŠ©çº¿
 * @param {Object} model éœ€è¦æ·»åŠ è¾…åŠ©çº¿çš„THREE.Object3D
 * @param {Number} thickness çº¿æ¡çš„é•¿åº¦
 * @param {Number} height çº¿æ¡çš„é«˜åº¦
 */
function addAxesHelper(model, thickness, height) {
  // è®¾ç½®ä¸‰ä¸ªæ–¹å‘çš„åœ†é”¥+åœ†é”¥,å½¢æˆåæ ‡è¾…åŠ©çº¿
  const axesHelperArr = [
    {
      color: '#00FFB5',
      direction: 'x',
      cylinderDirection: 'z',
      goneDirection: 'y',
      angle: -Math.PI / 2,
    },
    {
      color: '#2F88FE',
      direction: 'y',
      cylinderDirection: 'y',
      goneDirection: 'y',
      angle: -Math.PI / 2,
    },
    {
      color: '#F86C55',
      direction: 'z',
      cylinderDirection: 'x',
      goneDirection: 'y',
      angle: Math.PI / 2,
    },
  ];

  // å¾ªç¯æ–¹å‘æ•°ç»„
  for (let i = 0; i < axesHelperArr.length; i++) {
    // è·å–å„ä¸ªæ–¹å‘çš„é¢œè‰²,æ–¹å‘å€¼,æ—‹è½¬æ–¹å‘,æ—‹è½¬è§’åº¦,åœ†é”¥æŒ‡ç¤ºæ–¹å‘
    const { color, direction, cylinderDirection, goneDirection, angle } = axesHelperArr[i];
    // é»˜è®¤ç²—ç»†ç¼©å°100å€
    const crude = thickness / 100;

    // åˆ›å»ºåœ†æŸ±å‡ ä½•ä½“
    const geometryCylinder = new THREE.CylinderGeometry(crude, crude, height, 32);
    // åˆ›å»ºåœ†æŸ±æè´¨
    const materialCylinder = new THREE.MeshBasicMaterial({ color });
    // ç”Ÿæˆåœ†æŸ±ç‰©ä½“
    const meshCylinder = new THREE.Mesh(geometryCylinder, materialCylinder);
    // è®¾ç½®åœ†æŸ±ç‰©ä½“é»˜è®¤çš„æ—‹è½¬æ–¹å‘ä¸‹çš„æŒ‡å®šæ—‹è½¬è§’åº¦
    meshCylinder.rotation[cylinderDirection] = angle;
    // å°†åœ†æŸ±çš„åº•éƒ¨å¯¹å‡†ä¸­å¿ƒç‚¹
    meshCylinder.position[direction] = height / 2;

    // åˆ›å»ºåœ†é”¥å‡ ä½•ä½“
    const geometryCone = new THREE.ConeGeometry(crude * 2, 0.05, 32);
    // åˆ›å»ºåœ†é”¥æè´¨
    const materialCone = new THREE.MeshBasicMaterial({ color });
    // ç”Ÿæˆåœ†é”¥ç‰©ä½“
    const meshCone = new THREE.Mesh(geometryCone, materialCone);
    // è®¾ç½®åœ†é”¥ä½ç½®ä¸ºåœ†é”¥çš„åº•éƒ¨
    meshCone.position[goneDirection] = height / 2;

    // åœ†é”¥æ·»åŠ åˆ°åœ†æŸ±ä¸­
    meshCylinder.add(meshCone);

    // åœ†æŸ±+åœ†é”¥çš„ç®­å¤´ç»„åˆæ·»åŠ åˆ°æŒ‡å®šçš„Object3Då¯¹è±¡ä¸­
    model.add(meshCylinder);
  }
}

addAxesHelper(scene, 1.3, 1);

// æ¸²æŸ“å‡½æ•°
function render() {
  // æ›´æ–°æ¸²æŸ“å™¨
  renderer.render(scene, camera);
  // æ›´æ–°è½¨é“æ§åˆ¶å™¨
  controls.update();
  requestAnimationFrame(render);
}

onMounted(() => {
  render();
  document.getElementById('app').appendChild(renderer.domElement);

  // çª—å£ç¼©æ”¾å¤„ç†
  window.addEventListener('resize', () => {
    // è®¾ç½®æ¸²æŸ“å™¨å°ºå¯¸
    renderer.setSize(window.innerWidth, window.innerHeight);
    // æ›´æ–°ç›¸æœºå®½é«˜æ¯”
    camera.aspect = window.innerWidth / window.innerHeight;
    // æ›´æ–°ç›¸æœºæŠ•å½±çŸ©é˜µ
    camera.updateProjectionMatrix();
    // è®¾ç½®æ¸²æŸ“å™¨åƒç´ æ¯”
    renderer.setPixelRatio(window.innerWidth / window.innerHeight);
  });
});
</script>

<style lang="scss" scoped></style>
```

## 4. æ€»ç»“:
é€šè¿‡ä½¿ç”¨åœ†æŸ±ä½“ä¸åœ†æŸ±ä½“ç»„åˆçš„æ–¹å¼,å°†ä¸€ä¸ªåœ†æŸ±ä½“ä¸åœ†é”¥ä½“ç»„åˆä¸ºä¸€ä¸ªæ–¹å‘çš„è¾…åŠ©çº¿,ä»¥ç›¸åŒçš„æ–¹æ³•ç»„åˆå‡ºä¸‰ä¸ªæ–¹å‘çš„è¾…åŠ©çº¿,ä¹‹åæŒ‡å®šå®½åº¦ä¸è¾…åŠ©çº¿çš„ç²—ç»†,ä½œç”¨äºæŒ‡å®šæ¨¡å‹çš„ä¸åŒæ–¹å‘å³å¯å®ç°

ä»¥ä¸Šå°±æ˜¯æœ¬ç« åšå®¢çš„å…¨éƒ¨å†…å®¹äº†,å¸Œæœ›å¯ä»¥å¯¹ä½ æœ‰æ‰€å¸®åŠ©ğŸ˜