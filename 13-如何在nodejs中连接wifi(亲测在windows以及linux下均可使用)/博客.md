# å¦‚ä½•åœ¨nodejsä¸­è¿æ¥wifi(äº²æµ‹åœ¨windowsä»¥åŠlinuxä¸‹å‡å¯ä½¿ç”¨)ğŸš€

## é—®é¢˜: å¦‚ä½•åœ¨nodejsä¸­è¿æ¥wifi?

### 1. ä½¿ç”¨æŠ€æœ¯æ ˆ: Vue3+Vite+Electron
å› ä¸ºéœ€è¦ä½¿ç”¨åˆ°nodejs,æ‰€ä»¥å•çº¯çš„Vue3+Viteå¹¶ä¸èƒ½æ»¡è¶³éœ€æ±‚,å…·ä½“çš„åŸå› å¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« [Vueè¿æ¥ä¸²å£](https://juejin.cn/post/7353453349997903898),åŒ…æ‹¬å¦‚ä½•æ­å»ºä¸€ä¸ªç®€å•çš„Vue3+Vite+Electronçš„æ¡†æ¶ä¹Ÿå¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« [æ­å»ºä¸€ä¸ªVue+Electronçš„æ¡†æ¶](https://juejin.cn/post/7353877562303103013),æœ‰è¿™ä¸¤ç¯‡æ–‡ç« ä½œä¸ºé“ºå«,å°±å¯ä»¥ç›´æ¥ç ä»£ç äº†

### 2. ç¬¬ä¸‰æ–¹åº“ä»‹ç»
è¿™é‡Œä½¿ç”¨äº†ä½¿ç”¨`node-wifi`åº“,åœ¨æ¡†æ¶æ­å»ºå¥½ä¹‹å,å¯ä»¥ç›´æ¥ä½¿ç”¨npmæˆ–è€…yarnå·¥å…·ä¸‹è½½æ­¤åº“

### 3. å…³é”®ä»£ç ç‰‡æ®µ
1. è¿æ¥wifiå‰ç½®æ“ä½œ
```js
// å¯¼å…¥wifi
const wifi = require('node-wifi');

// åˆå§‹åŒ– WiFi æ¨¡å—
wifi.init({
  iface: null, // åœ¨ Windows ä¸Šé€šå¸¸ä¸éœ€è¦æŒ‡å®šæ¥å£
});
```
2. æ£€æŸ¥wifiåˆ—è¡¨
```js
// æ‰«æå¯ç”¨çš„ WiFi ç½‘ç»œ
  wifi.scan((error, networks) => {
    if (error) {
      console.log(error);
      return;
    }
    // æ‰«ææˆåŠŸ,å¾—åˆ°wifiåˆ—è¡¨
    console.log(networks)
  });
```
3. è¿æ¥wifi
```js
// è¿æ¥åˆ° WiFi ç½‘ç»œ
  wifi.connect({ ssid: ç½‘ç»œåç§°, password: ç½‘ç»œå¯†ç  }, error => {
    if (error) {
      // wifiè¿æ¥å¤±è´¥
      console.log(error)
      return
    }
   // wifiè¿æ¥æˆåŠŸ
   console.log('wifiè¿æ¥æˆåŠŸ')     
```
4. æ–­å¼€wifi
```js
// æ–­å¼€å½“å‰è¿æ¥çš„ WiFi ç½‘ç»œ
  wifi.disconnect(error => {
    if (error) {
      console.log(error);
    } else {
      console.log('wifiè¿æ¥å·²æ–­å¼€!');
    }
  });
```
5. æ£€æŸ¥wifiè¿æ¥çŠ¶æ€
```js
wifi.getCurrentConnections((error, currentConnections) => {
    if (error) {
      console.error(error);
      return;
    }
    // å¦‚æœå­˜åœ¨å·²è¿æ¥çš„wifiä¿¡æ¯
    if (currentConnections.length > 0) {
     console.log(currentConnections[0])
    } else {
      console.log('å½“å‰æœªè¿æ¥åˆ°ä»»ä½• WiFi ç½‘ç»œã€‚');
    }
  });
```

æœ‰äº†ä»¥ä¸Šçš„å‡ ä¸ª`node-wifi`çš„APIä»£ç ç‰‡æ®µ,å†™èµ·æ¥å°±ç®€å•å¤šäº†,åªéœ€è¦æ ¹æ®apiæ¥å†™ä¸šåŠ¡é€»è¾‘å³å¯

### 4. nodejsè¿æ¥wifiæ¡ˆä¾‹
ä»¥ä¸‹æ˜¯æˆ‘åšçš„ä¸€ä¸ªå»ºè®®çš„wifiè¿æ¥é¡µé¢,åŒ…å«äº†wifiåˆ—è¡¨å±•ç¤º,wifiè¿æ¥,wifiæ–­å¼€è¿æ¥,åˆ·æ–°wifiç­‰åŠŸèƒ½,å…ˆçœ‹æ•ˆæœå›¾

![wifiåˆ—è¡¨](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5bb1acead6eb49aa84d06409f6851284~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=834&h=900&s=46134&e=png&b=ffffff)

![è¾“å…¥å¯†ç ](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7b85de015dbd42979e0a006783eb42b1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=853&h=800&s=49810&e=png&b=8c8c8c)

![è¿æ¥æˆåŠŸ](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0382a64655b24fdfb3571c656621d04d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=843&h=881&s=50726&e=png&b=ffffff)

![æ–­å¼€wifiè¿æ¥](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0b061a531f7842d48e8f5b84b145d32d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=789&h=852&s=49084&e=png&b=ffffff)

#### wifiè¿æ¥å·¥å…·æºç :
```js
<!--
 * @Author: wangzhiyu <w19165802736@163.com>
 * @Date: 2023-12-15 11:05:46
 * @LastEditTime: 2024-04-17 17:17:10
 * @Descripttion: Homeé¡µé¢
-->
<template>
  <div>
    <!-- åˆ¤æ–­wifiæ˜¯å¦å¼€å¯ -->
    <a-button class="refreshWifi" @click="getWifiList" type="primary">åˆ·æ–°wifi</a-button>
    <!-- åˆ·æ–°wifi -->
    <div v-if="wifiOpen" class="wifiList">
      <!-- å¾ªç¯å±•ç¤ºå½“å‰æ‰«æåˆ°çš„wifiåˆ—è¡¨ -->
      <div v-for="item in wifiList" class="wifiItem">
        <!-- wifiåç§° -->
        <div class="wifiSSid">{{ item.ssid }}</div>
        <!-- è¿æ¥wifi -->
        <a-button
          :type="item.isConnect ? 'default' : 'primary'"
          :danger="item.isConnect"
          @click="
            () => {
              if (item.isConnect) {
                // æ–­å¼€wifi
                disconnectWifi(item);
              } else {
                // è¿æ¥wifi
                connectWifi(item);
              }
            }
          "
        >
          {{ item.isConnect ? 'æ–­å¼€ wifi' : 'è¿æ¥ wifi' }}
        </a-button>
      </div>
    </div>

    <!-- wifiåŠŸèƒ½æœªå¼€å¯æç¤º -->
    <div v-else>æœ¬æœºwifiæœªå¼€å¯,è¯·å¼€å¯wifiåé‡è¯•!</div>

    <!-- è¿æ¥wifiè¾“å…¥å¯†ç å¼¹æ¡† -->
    <a-modal :width="550" v-model:open="openModal" title="è¿æ¥wifi" @ok="handleOk" cancelText="å–æ¶ˆè¿æ¥" okText="ç¡®è®¤è¿æ¥">
      <a-form>
        <a-form-item label="wifiåç§°">
          <a-input disabled :value="selectWifiInfo.ssid"></a-input>
        </a-form-item>
        <a-form-item label="wifiå¯†ç ">
          <a-input-password v-model:value="wifiPassword" placeholder="è¯·è¾“å…¥wifiå¯†ç " />
        </a-form-item>
      </a-form>
    </a-modal>
  </div>
</template>

<script setup>
import { message } from 'ant-design-vue';
const wifi = require('node-wifi');

// wifiåˆ—è¡¨
const wifiList = ref([]);

// åˆ¤æ–­æ˜¯å¦å¼€å¯ç½‘ç»œ
const wifiOpen = ref(false);

// å¼¹æ¡†å¼€å¯/å…³é—­çŠ¶æ€
const openModal = ref(false);

// é€‰ä¸­è¿æ¥çš„wifiä¿¡æ¯
const selectWifiInfo = ref({});

// wifiå¯†ç 
const wifiPassword = ref('');

// åˆå§‹åŒ– WiFi æ¨¡å—
wifi.init({
  iface: null, // åœ¨ Windows ä¸Šé€šå¸¸ä¸éœ€è¦æŒ‡å®šæ¥å£
});

// è·å–wifiåˆ—è¡¨
const getWifiList = () => {
  // æ‰«æå¯ç”¨çš„ WiFi ç½‘ç»œ
  wifi.scan((error, networks) => {
    // æ‰«æwifiå¤±è´¥
    if (error) {
      wifiOpen.value = false;
      console.log(error, 'error');
      return;
    }
    wifiOpen.value = true;

    // wifiæ‰«ææˆåŠŸ,è·å–wifiåˆ—è¡¨
    wifiList.value = networks.filter(item => item.ssid);

    // æ£€æŸ¥å½“å‰wifiçš„è¿æ¥çŠ¶æ€
    getWifiState();
  });
};
getWifiList();

// è·å–å½“å‰ç½‘ç»œè¿æ¥ä¿¡æ¯
const getWifiState = () => {
  // è·å–å½“å‰è¿æ¥çš„ WiFi ç½‘ç»œä¿¡æ¯
  wifi.getCurrentConnections((error, currentConnections) => {
    if (error) {
      console.error(error);
      return;
    }
    // å¦‚æœå­˜åœ¨å·²è¿æ¥çš„wifiä¿¡æ¯
    if (currentConnections.length > 0) {
      // å½“å‰å·²ç»è¿æ¥çš„ WiFi ç½‘ç»œ
      const connectedNetwork = currentConnections[0].mac;

      // æ ‡è®°å½“å‰è¿æ¥çš„wifi
      wifiList.value.forEach(item => {
        if (item.ssid === connectedNetwork) {
          item.isConnect = true;
        } else {
          item.isConnect = false;
        }
      });
    } else {
      console.log('å½“å‰æœªè¿æ¥åˆ°ä»»ä½• WiFi ç½‘ç»œã€‚');
    }
  });
};

// è¿æ¥wifi
const connectWifi = wifiInfo => {
  // æ‰“å¼€å¼¹æ¡†
  openModal.value = true;
  selectWifiInfo.value = wifiInfo;
};

// ç¡®è®¤è¿æ¥wifi
const handleOk = () => {
  // è¿æ¥åˆ° WiFi ç½‘ç»œ
  wifi.connect({ ssid: selectWifiInfo.value.ssid, password: wifiPassword.value }, error => {
    if (error) {
      // æç¤ºwifiè¿æ¥å¤±è´¥
      message.error('wifiè¿æ¥å¤±è´¥,è¯·æ£€æŸ¥è´¦å·å¯†ç åé‡è¯•!');
    } else {
      // æç¤ºwifiè¿æ¥æˆåŠŸ
      message.success('wifiè¿æ¥æˆåŠŸ!');

      // æ ‡è®°å½“å‰è¿æ¥çš„wifi
      wifiList.value.forEach(item => {
        if (item.ssid === selectWifiInfo.value.ssid) {
          item.isConnect = true;
        } else {
          item.isConnect = false;
        }
      });
    }

    // æ¸…ç©ºå¯†ç 
    wifiPassword.value = '';
    // å…³é—­å¼¹æ¡†
    openModal.value = false;
  });
};

// æ–­å¼€wifiè¿æ¥
const disconnectWifi = () => {
  // æ–­å¼€å½“å‰è¿æ¥çš„ WiFi ç½‘ç»œ
  wifi.disconnect(error => {
    if (error) {
      console.log(error);
    } else {
      message.success('wifiè¿æ¥å·²æ–­å¼€!');
      wifiList.value.forEach(item => {
        item.isConnect = false;
      });
    }
  });
};
</script>

<style lang="scss">
.refreshWifi {
  position: absolute;
  left: 30%;
}
.wifiList {
  position: relative;
  width: 30%;
  min-width: 200px;
  margin: 0 auto;
  border: 1px solid #000;
  border-radius: 10px;
  max-height: 90vh;
  overflow: auto;

  &::-webkit-scrollbar {
    /*æ»šåŠ¨æ¡æ•´ä½“æ ·å¼*/
    width: 10px; /*é«˜å®½åˆ†åˆ«å¯¹åº”æ¨ªç«–æ»šåŠ¨æ¡çš„å°ºå¯¸*/
    height: 1px;
  }
  &::-webkit-scrollbar-thumb {
    /*æ»šåŠ¨æ¡é‡Œé¢å°æ–¹å—*/
    border-radius: 10px;
    box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
    background: #535353;
  }
  &::-webkit-scrollbar-track {
    /*æ»šåŠ¨æ¡é‡Œé¢è½¨é“*/
    box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
    border-radius: 10px;
    background: #ededed;
  }
  .wifiItem {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 50px;
    border-bottom: 1px solid #000;
    padding-right: 50px;
    box-sizing: border-box;
    &:last-child {
      border-bottom: none;
    }
    .wifiSSid {
      width: 75%;
      white-space: nowrap; /* ç¦æ­¢æ–‡æœ¬æ¢è¡Œ */
      overflow: hidden; /* éšè—æº¢å‡ºéƒ¨åˆ† */
      text-overflow: ellipsis; /* æ˜¾ç¤ºçœç•¥å· */
      padding-left: 20px;
    }
  }
}
</style>
```

### 5. ä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡åˆ†äº«çš„å…¨éƒ¨å†…å®¹äº†,æœ‰é—®é¢˜æ¬¢è¿ç§ä¿¡ğŸ˜