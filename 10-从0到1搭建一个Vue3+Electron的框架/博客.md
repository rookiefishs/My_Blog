# ä»0åˆ°1æ­å»ºä¸€ä¸ªVue3+Electronçš„æ¡†æ¶

### 1. å‰è¨€: [ä¸Šç¯‡æ–‡ç« ](https://juejin.cn/post/7353453349997903898)ä¸­ä½¿ç”¨åˆ°äº†Vue+Electronæ¡†æ¶,è¿™ä¸€ç¯‡æ–‡ç« ä¸»è¦è®²è§£è¿™ä¸ªæ¡†æ¶å¦‚ä½•æ­å»º

### 2. Vue3+Viteé¡¹ç›®æ­å»º

1. æ‰§è¡Œå‘½ä»¤è¡Œ,åˆ›å»º`Vue3+Vite`è„šæ‰‹æ¶: `npm create vite` æˆ– `yarn create vite`
![åˆ›å»ºVue3+Viteè„šæ‰‹æ¶](https://img-blog.csdnimg.cn/img_convert/5415f7858e3c4ff0e6607d84d001c865.png)
2. ä¿®æ”¹è„šæ‰‹æ¶ä¸­çš„æ— ç”¨éƒ¨åˆ†
   - åˆ é™¤src/componentsä¸‹çš„æ‰€æœ‰æ–‡ä»¶
   - ä¿®æ”¹src/App.vueå†…å®¹
       ```js
       <!--
         * @Author: wangzhiyu <w19165802736@163.com>
         * @version: 1.0.0
         * @Date: 2024-04-04 23:00:32
         * @LastEditTime: 2024-04-04 23:06:55
         * @Descripttion: æ ¹ç»„ä»¶
        -->
        <template>App</template>
        <script setup></script>
        <style></style>
       ```
3. åˆå§‹åŒ–é¡¹ç›®ä¾èµ–
    ```js
    // package.json
    // é¦–å…ˆåˆå§‹åŒ–é¡¹ç›®åŸºç¡€ä¾èµ–
    npm i æˆ– yarn add
    // ä¸‹è½½å…³äºelectronä»¥åŠé¡¹ç›®æ‰€éœ€çš„ä¾èµ–åŒ… 
    npm install electron@23.0.0 electron-browser-storage@1.0.7 electron-builder@23.6.0 electron-packager@17.1.1 concurrently@7.6.0 cross-env@7.0.3 -D
    // æˆ–
    yarn add electron@23.0.0 electron-browser-storage@1.0.7 electron-builder@23.6.0 electron-packager@17.1.1 concurrently@7.6.0 cross-env@7.0.3 -D
    ```
    
  ### 3. å¢åŠ electronæ”¯æŒ

  1. è‡ªå®šä¹‰package.jsonçš„`scripts`
        ```js
        // package.json
        "scripts": {
        // å¯åŠ¨å¼€å‘æœåŠ¡å™¨(æµè§ˆå™¨ç«¯è°ƒè¯•ä½¿ç”¨)
        "dev": "vite dev", 
        // æ‰“åŒ…å‰ç«¯åŒ…
        "build": "vite build", 
        // å¯åŠ¨å¼€å‘è°ƒè¯•æ¡Œé¢ç«¯
        "electron:start": " concurrently -k \"vite \" \"cross-env IS_DEV=true electron . \"",
        '// æ‰“åŒ…æ¡Œé¢ç«¯åº”ç”¨(å‰ææ˜¯å‰ç«¯åŒ…å·²ç»æ‰“å¥½äº†)
        "electron:build.win": "electron-builder --win --dir",
         }
        ```
2.  æŒ‡å®šæ‰“åŒ…çš„æ¡Œé¢ç«¯åº”ç”¨ç¨‹åºæ–‡ä»¶å­˜å­˜æ”¾çš„åœ°å€
    ```js
    // package.json
    {
    // ...å…¶ä»–é…ç½®
    "build": {
    "directories": {
      "output": "dist_electron"
        }
       }
      }
    ```
3. vite.config.jsä¸­è®¾ç½®æ–‡ä»¶è·¯å¾„ä¸º./
    ```js
    // vite.config.js
    import { defineConfig } from 'vite'
    import vue from '@vitejs/plugin-vue'

    // https://vitejs.dev/config/
    export default defineConfig({
      base: './',
      plugins: [vue()],
    })
    ```
    
4.  æŒ‡å®šnodejså…¥å£æ–‡ä»¶(electronçš„æ‰§è¡Œæ–‡ä»¶),å¦å¤–æ³¨æ„åˆ æ‰`package.json`ä¸­çš„`module`
    ```js
    // package.json
    {
    // ...å…¶ä»–é…ç½®
    "main": "electron/index.js",
    }
    
    // åœ¨é¡¹ç›®çš„æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªelectronæ–‡ä»¶å¤¹,å¹¶æ–°å»ºä¸€ä¸ªindex.js,ä½œä¸ºelectronçš„å…¥å£æ‰§è¡Œæ–‡ä»¶
    ```
    
5. ç¼–å†™electron/index.jså†…å®¹
    ```js
    /* 
     * @Author: wangzhiyu <w19165802736@163.com>
     * @version: 0.0.0
     * @Date: 2024-04-04 23:00:32
     * @LastEditTime: 2024-04-04 23:29:27
     * @Descripttion: electronå…¥å£æ–‡ä»¶
    */
    // !: è¿™é‡Œçš„electron.jså°†ä¼šåœ¨nodeç¯å¢ƒä¸‹è¿è¡Œ

    const path = require('path')

    // å¯¼å…¥electronAPI
    const { app, BrowserWindow, Menu, ipcMain } = require('electron');

    // åˆå§‹åŒ–æ¡Œé¢ç«¯åº”ç”¨
    function createWindow() {
      // TODO: æ ¹æ®ä¸åŒç¯å¢ƒè®¾ç½®ä¸åŒçš„åº”ç”¨é…ç½®
      const isDev = process.env.IS_DEV === 'true'
      console.log(isDev, 'isDev');

      // ä¸»çª—å£
      let mainWindow = null

      // å¦‚æœå½“å‰ä¸ºå¼€å‘ç¯å¢ƒ,åˆ™æ‰§è¡Œå¼€å‘ç¯å¢ƒçš„é…ç½®
      if (isDev === 'true') {
        // æ ¹æ®ä¸åŒç¯å¢ƒè®¾ç½®ä¸åŒçš„åº”ç”¨é…ç½®
        mainWindow = new BrowserWindow({
          fullscreenable: false,
          fullscreen: false,
          simpleFullscreen: true,
          webPreferences: {
            nodeIntegration: true,
            contextIsolation: false,
            webSecurity: false,
            allowRunningInsecureContent: true,
          },
        });
        // æ‰“å¼€æ§åˆ¶å°
        mainWindow.webContents.openDevTools();
      } else {
        // ç”Ÿäº§ç¯å¢ƒçš„é…ç½®
        mainWindow = new BrowserWindow({
          fullscreenable: false,
          fullscreen: false,
          simpleFullscreen: true,
          webPreferences: {
            nodeIntegration: true,
            contextIsolation: false,
            webSecurity: false,
            allowRunningInsecureContent: true,
          },
        });
      }

      // å¦‚æœä¸º dev ç¯å¢ƒåŠ è½½æœ¬åœ°url,å¦åˆ™åŠ è½½æ‰“åŒ…åçš„index.html
      mainWindow.loadURL(isDev ? 'http://localhost:5173' : `file://${path.join(__dirname, '../dist/index.html')}`);
    }

    // æ­¤æ–¹æ³•å°†åœ¨Electronå®Œæˆåè°ƒç”¨,åˆå§‹åŒ–,å¹¶å‡†å¤‡åˆ›å»ºæµè§ˆå™¨çª—å£ã€‚
    app.whenReady().then(() => {
      // åˆ›å»ºwindowsåº”ç”¨
      createWindow();

      // å»¶è¿Ÿ3s ç­‰å¾…åº”ç”¨æ¿€æ´»
      setTimeout(() => {
        console.log('å·²ç»è¿‡äº†3säº†');
        app.on('activate', function () {
          // å¦‚æœåº”ç”¨æ¿€æ´»å,çª—å£ä¾ç„¶ä¸º0,åˆ™é‡æ–°åˆ›å»ºwindowsåº”ç”¨
          if (BrowserWindow.getAllWindows().length === 0) createWindow();
        });
      }, 3000)
    });

    // åº”ç”¨é”€æ¯è§¦å‘
    app.on('window-all-closed', () => {
      if (process.platform !== 'darwin') {
        app.quit();
      }
    });
    ```
    
6. ç„¶åæ‰§è¡Œå¯åŠ¨æ¡Œé¢ç«¯åº”ç”¨æœåŠ¡(å¼€å‘ç¯å¢ƒ)
```js
npm run electron:start
// æˆ–
yarn electron:start
// å³å¯æ¢å‡ºä»¥ä¸‹çª—å£,è¿™ä¸ªçª—å£å°±æ˜¯å¼€å‘ç¯å¢ƒä¸‹çš„æ¡Œé¢ç«¯åº”ç”¨
```
![æ•ˆæœå›¾](https://img-blog.csdnimg.cn/img_convert/b4620d3cbc792c50c6ae7ddf67ca6a76.png)

### 4. æ‰“åŒ…æ¡Œé¢ç«¯åº”ç”¨
```js
// é¦–å…ˆæ‰§è¡Œé™æ€èµ„æºæ‰“åŒ…å‘½ä»¤
yarn build
// ç„¶åæ‰“åŒ…æ¡Œé¢ç«¯åº”ç”¨ç¨‹åº
yarn electron:build.win

// ä¹‹åå»é¡¹ç›®æ ¹ç›®å½•ä¸‹ä¼šçœ‹åˆ°ä¸€ä¸ªdist_electronæ–‡ä»¶å¤¹,æ‰“å¼€åç‚¹å¼€win-unpackedæ–‡ä»¶å¤¹,åŒå‡».extåº”ç”¨ç¨‹åºå³å¯å¯åŠ¨
```
![image.png](https://img-blog.csdnimg.cn/img_convert/bf9c184101ea02d07d349b6ce5c970fd.png)

### 5. æ€»ç»“: ä»¥ä¸Šå°±æ˜¯Vue3+Vite+Electronæ¡†æ¶çš„æ­å»ºè¿‡ç¨‹,Vue2ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†,åªéœ€è¦æ›´æ”¹ä¸€äº›é…ç½®å³å¯,å°†viteæ”¹ä¸ºvue-cli,å…¶ä½™æ²¡æœ‰ä»€ä¹ˆéœ€è¦æ”¹åŠ¨çš„,å¯¹æ­å»ºæ¡†æ¶æœ‰ç–‘é—®çš„ç‚¹,æˆ–è€…é‡åˆ°é—®é¢˜äº†æ¬¢è¿ç›´æ¥ç»™æˆ‘å‘ç§ä¿¡ğŸ˜